<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>공지사항</title>
    <style>
        /* 페이지 디자인 */
        body {
            font-family: 'Malgun Gothic', sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        
        /* 버튼 디자인 */
        .button-group {
            margin-bottom: 20px;
            text-align: center;
        }
        
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 16px;
        }
        
        button:hover {
            background-color: #45a049;
        }
        
        /* 공지사항 테이블 디자인 */
        table {
            width: 100%;
            background-color: white;
            border-collapse: collapse;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: #4CAF50;
            color: white;
        }
        
        tr:hover {
            background-color: #f5f5f5;
        }
        
        /* 입력 폼 디자인 */
        .form-container {
            background-color: white;
            padding: 20px;
            margin-top: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: none;
        }
        
        input[type="text"], textarea {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        
        textarea {
            height: 100px;
            resize: vertical;
        }
        
        /* 로딩 표시 */
        .loading {
            text-align: center;
            padding: 20px;
            font-style: italic;
            color: #666;
        }
        
        /* 에러 메시지 */
        .error {
            color: red;
            text-align: center;
            padding: 20px;
        }
        
        /* 액션 버튼들 */
        .action-buttons {
            display: flex;
            gap: 5px;
        }
        
        .edit-btn, .delete-btn {
            padding: 5px 10px;
            font-size: 14px;
        }
        
        .edit-btn {
            background-color: #2196F3;
        }
        
        .edit-btn:hover {
            background-color: #0b7dda;
        }
        
        .delete-btn {
            background-color: #f44336;
        }
        
        .delete-btn:hover {
            background-color: #da190b;
        }
    </style>
</head>
<body>
    <h1>📢 공지사항</h1>
    
    <!-- 버튼들 -->
    <div class="button-group">
        <button onclick="loadNotices()">🔄 새로고침</button>
        <button onclick="showAddForm()">➕ 공지 추가</button>
    </div>
    
    <!-- 공지사항 추가/수정 폼 -->
    <div id="noticeForm" class="form-container">
        <h2 id="formTitle">새 공지사항 작성</h2>
        <input type="hidden" id="editIndex" value="">
        <input type="text" id="title" placeholder="제목을 입력하세요">
        <textarea id="content" placeholder="내용을 입력하세요"></textarea>
        <input type="text" id="author" placeholder="작성자 이름">
        <br><br>
        <button onclick="saveNotice()">💾 저장</button>
        <button onclick="hideForm()">❌ 취소</button>
    </div>
    
    <!-- 공지사항 목록 -->
    <div id="noticeList" class="loading">공지사항을 불러오는 중...</div>

    <script>
        // ⚠️ 여기에 여러분의 Google Sheets ID를 넣어주세요!
        const SHEET_ID = '여기에_시트_ID_넣기';
        const API_KEY = 'AIzaSyDwD8Xc3Y2p3Tk0oQ-5rFkZt5aL_WYVxqk'; // 임시 API 키 (나중에 자신의 키로 교체)
        const SHEET_NAME = 'Sheet1'; // 시트 이름 (보통 Sheet1)
        
        // 공지사항 불러오기
        async function loadNotices() {
            const noticeList = document.getElementById('noticeList');
            noticeList.innerHTML = '<div class="loading">불러오는 중...</div>';
            
            try {
                // Google Sheets API로 데이터 가져오기
                const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`;
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error('데이터를 불러올 수 없습니다.');
                }
                
                const data = await response.json();
                const rows = data.values || [];
                
                if (rows.length <= 1) {
                    noticeList.innerHTML = '<div class="error">공지사항이 없습니다.</div>';
                    return;
                }
                
                // 테이블 만들기
                let html = `
                    <table>
                        <thead>
                            <tr>
                                <th>번호</th>
                                <th>제목</th>
                                <th>내용</th>
                                <th>작성자</th>
                                <th>날짜</th>
                                <th>관리</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                // 첫 번째 행은 헤더이므로 건너뛰고 시작
                for (let i = 1; i < rows.length; i++) {
                    const row = rows[i];
                    html += `
                        <tr>
                            <td>${row[0] || ''}</td>
                            <td>${row[1] || ''}</td>
                            <td>${row[2] || ''}</td>
                            <td>${row[3] || ''}</td>
                            <td>${row[4] || ''}</td>
                            <td>
                                <div class="action-buttons">
                                    <button class="edit-btn" onclick="editNotice(${i})">✏️ 수정</button>
                                    <button class="delete-btn" onclick="deleteNotice(${i})">🗑️ 삭제</button>
                                </div>
                            </td>
                        </tr>
                    `;
                }
                
                html += '</tbody></table>';
                noticeList.innerHTML = html;
                
            } catch (error) {
                noticeList.innerHTML = `
                    <div class="error">
                        오류가 발생했습니다: ${error.message}<br>
                        <small>Sheet ID와 공유 설정을 확인해주세요.</small>
                    </div>
                `;
            }
        }
        
        // 공지사항 추가 폼 표시
        function showAddForm() {
            document.getElementById('formTitle').textContent = '새 공지사항 작성';
            document.getElementById('editIndex').value = '';
            document.getElementById('title').value = '';
            document.getElementById('content').value = '';
            document.getElementById('author').value = '';
            document.getElementById('noticeForm').style.display = 'block';
        }
        
        // 폼 숨기기
        function hideForm() {
            document.getElementById('noticeForm').style.display = 'none';
        }
        
        // 공지사항 저장 (실제로는 Google Apps Script 필요)
        function saveNotice() {
            alert('⚠️ 웹사이트에서 직접 수정하려면 Google Apps Script 설정이 필요합니다.\n\n지금은 Google Sheets에서 직접 수정해주세요!');
            hideForm();
        }
        
        // 공지사항 수정
        function editNotice(index) {
            alert('⚠️ 수정 기능을 사용하려면 Google Apps Script 설정이 필요합니다.\n\n지금은 Google Sheets에서 직접 수정해주세요!');
        }
        
        // 공지사항 삭제
        function deleteNotice(index) {
            if (confirm('정말 삭제하시겠습니까?')) {
                alert('⚠️ 삭제 기능을 사용하려면 Google Apps Script 설정이 필요합니다.\n\n지금은 Google Sheets에서 직접 삭제해주세요!');
            }
        }
        
        // 페이지 로드 시 공지사항 불러오기
        window.onload = function() {
            loadNotices();
        };
    </script>
</body>
</html>